
@replaceStep1 = 
EXTRACT
        aban8  string, 
        abalky  string,
        abtax  string,
        abalph  string,
        abdc  string,
        abmcu  string,
        absic  string,
        ablngp  string,
        abat1  string,
        abcm  string,
        abtaxc  string,
        abat2  string,
        abat3  string,
        abat4  string,
        abat5  string,
        abatp  string,
        abatr  string,
        abatpr  string,
        abab3  string,
        abate  string,
        absbli  string,
        abeftb  string,
        aban81  string,
        aban82  string,
        aban83  string,
        aban84  string,
        aban86  string,
        aban85  string,
        abac01  string,
        abac02  string,
        abac03  string,
        abac04  string,
        abac05  string,
        abac06  string,
        abac07  string,
        abac08  string,
        abac09  string,
        abac10  string,
        abac11  string,
        abac12  string,
        abac13  string,
        abac14  string,
        abac15  string,
        abac16  string,
        abac17  string,
        abac18  string,
        abac19  string,
        abac20  string,
        abac21  string,
        abac22  string,
        abac23  string,
        abac24  string,
        abac25  string,
        abac26  string,
        abac27  string,
        abac28  string,
        abac29  string,
        abac30  string,
        abglba  string,
        abpti  string,
        abpdi  string,
        abmsga  string,
        abrmk  string,
        abtxct  string,
        abtx2  string,
        abalp1  string,
        aburcd  string,
        aburdt  string,
        aburat  string,
        aburab  string,
        aburrf  string,
        abuser  string,
        abpid  string,
        abupmj  string,
        abjobn  string,
        abupmt  string,
        abprgf  string,
        absccltp  string,
        abticker  string,
        abexchg  string,
        abduns  string,
        abclass01  string,
        abclass02  string,
        abclass03  string,
        abclass04  string,
        abclass05  string,
        abnoe  string,
        abgrowthr  string,
        abyearstar  string,
        abaempgp  string,
        abactin  string,
        abrevrng  string,
        absyncs  string,
        abperrs  string,
        abcaad  string

FROM "adl://lakehillman.azuredatalakestore.net/DATA/E1/F0101/Transient/F0101"
  USING Extractors.Text(delimiter: 'Æ', skipFirstNRows: 1, quoting: false);


@replaceStep2 =
    SELECT aban8,
           abalky,
           abtax,
           abalph.Replace( "\t","" ).Replace( "\r\n","").Replace("\n", "").Replace("\r","") AS abalph,
           abdc,
           abmcu,
           absic,
           ablngp,
           abat1,
           abcm,
           abtaxc,
           abat2,
           abat3,
           abat4,
           abat5,
           abatp,
           abatr,
           abatpr,
           abab3,
           abate,
           absbli,
           abeftb,
           aban81,
           aban82,
           aban83,
           aban84,
           aban86,
           aban85,
           abac01,
           abac02,
           abac03,
           abac04,
           abac05,
           abac06,
           abac07,
           abac08,
           abac09,
           abac10,
           abac11,
           abac12,
           abac13,
           abac14,
           abac15,
           abac16,
           abac17,
           abac18,
           abac19,
           abac20,
           abac21,
           abac22,
           abac23,
           abac24,
           abac25,
           abac26,
           abac27,
           abac28,
           abac29,
           abac30,
           abglba,
           abpti,
           abpdi,
           abmsga,
           abrmk,
           abtxct,
           abtx2,
           abalp1,
           aburcd,
           aburdt,
           aburat,
           aburab,
           aburrf,
           abuser,
           abpid,
           abupmj,
           abjobn,
           abupmt,
           abprgf,
           absccltp,
           abticker,
           abexchg,
           abduns,
           abclass01,
           abclass02,
           abclass03,
           abclass04,
           abclass05,
           abnoe,
           abgrowthr,
           abyearstar,
           abaempgp,
           abactin,
           abrevrng,
           absyncs,
           abperrs,
           abcaad
    FROM @replaceStep1;


OUTPUT @replaceStep2
  TO "adl://lakehillman.azuredatalakestore.net/DATA/E1/F0101/Curated/F0101"
USING Outputters.Text(outputHeader: true, delimiter: 'Æ', quoting: false);
